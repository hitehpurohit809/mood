<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta name="description" content="A personal mood tracker to express your feelings." />
  <title>Babes Mood Tracker</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&family=Dancing+Script:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: "Quicksand", "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      background-color: #fdf0f5; /* Default soft pink background */
      transition: background-color 0.75s ease-in-out;
      padding: 15px;
      text-align: center;
    }
    .opening-quote {
      font-family: 'Dancing Script', cursive;
      font-size: clamp(1.1rem, 4vw, 1.4rem);
      color: #e3536b; /* Using a theme color */
      margin-bottom: 20px;
      padding: 10px;
      background-color: rgba(255, 255, 255, 0.7);
      border-radius: 8px;
      width: 100%;
      max-width: 500px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    h1 {
      margin-top: 0; /* Adjusted as quote is above */
      margin-bottom: 20px;
      font-size: clamp(1.6rem, 5vw, 2rem);
      color: #4a4a4a;
      font-weight: 600;
    }
    .emojis {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 25px;
    }
    .emoji-container {
      cursor: pointer;
      padding: 12px;
      border-radius: 50%;
      font-size: clamp(2.2rem, 10vw, 3rem);
      line-height: 1;
      color: #333;
      filter: grayscale(75%) opacity(0.65);
      transform: scale(0.9);
      transition: transform 0.25s ease-out, filter 0.25s ease-out, background-color 0.3s ease-out, box-shadow 0.3s ease-out;
    }
    .emoji-container:hover {
      filter: grayscale(20%) opacity(0.9);
      transform: scale(1.05);
    }
    .emoji-container.selected {
      filter: grayscale(0%) opacity(1);
      transform: scale(1.20);
      background-color: rgba(255, 139, 160, 0.2);
      box-shadow: 0 0 20px rgba(255, 139, 160, 0.6);
    }
    .mood-info {
      background-color: rgba(255, 255, 255, 0.93);
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 25px;
      width: 100%;
      max-width: 500px;
      box-shadow: 0 4px 18px rgba(0,0,0,0.12);
    }
    .emotion-text {
      font-size: clamp(1.05rem, 4vw, 1.25rem);
      font-weight: 700;
      margin-bottom: 10px;
      min-height: 1.2em;
      color: #333;
    }
    .quote {
      font-style: italic;
      color: #484848;
      margin-bottom: 15px;
      font-size: clamp(0.9rem, 3.5vw, 1rem);
      min-height: 1.1em;
      line-height: 1.55;
    }
    textarea {
      width: 100%;
      max-width: 500px;
      height: 130px;
      padding: 15px;
      border-radius: 10px;
      border: 1px solid #d0d0d0;
      resize: none;
      font-size: clamp(0.95rem, 3.8vw, 1.05rem);
      margin-bottom: 15px;
      box-shadow: inset 0 1px 4px rgba(0,0,0,0.08);
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    textarea:focus {
        border-color: #ff8ba0;
        box-shadow: 0 0 10px rgba(255, 139, 160, 0.4);
        outline: none;
    }
    .action-buttons { /* Container for save and call buttons */
        display: flex;
        flex-direction: column; /* Stack buttons on small screens */
        gap: 10px; /* Space between buttons */
        align-items: center;
        width: 100%;
        max-width: 500px;
    }
    button, .call-button { /* Apply similar base styling */
      width: 100%; /* Make buttons take full width of container */
      max-width: 300px; /* Max width for larger screens */
      margin-top: 5px;
      padding: 14px 25px; /* Adjusted padding */
      color: white;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      font-size: clamp(1rem, 4vw, 1.1rem);
      font-weight: 600;
      transition: transform 0.2s ease-out, box-shadow 0.2s ease-out, background-color 0.2s;
      text-decoration: none; /* For <a> styled as button */
      display: inline-block; /* For <a> styled as button */
    }
    #saveResponseButton {
      background-image: linear-gradient(45deg, #ff758c 0%, #ffc3a0 100%);
      box-shadow: 0 3px 7px rgba(255,100,130,0.35);
    }
    #saveResponseButton:hover:not(:disabled) {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 5px 12px rgba(255,100,130,0.45);
    }
    #saveResponseButton:active:not(:disabled) {
        transform: translateY(0px) scale(0.98);
        box-shadow: 0 2px 5px rgba(255,100,130,0.3);
    }
    #saveResponseButton:disabled {
        background-image: none;
        background-color: #cccccc;
        cursor: not-allowed;
        box-shadow: none;
    }
    .call-button { /* Styling for the "Can't Control" call button */
      background-color: #d9534f; /* A distinct, urgent color like red/orange */
      box-shadow: 0 3px 7px rgba(200,50,50,0.35);
    }
    .call-button:hover {
      background-color: #c9302c;
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 5px 12px rgba(200,50,50,0.45);
    }
    .call-button:active {
      transform: translateY(0px) scale(0.98);
      box-shadow: 0 2px 5px rgba(200,50,50,0.3);
    }
    .save-status {
        margin-top: 15px;
        font-size: clamp(0.9rem, 3.5vw, 0.95rem);
        color: #e3536b;
        font-weight: bold;
        min-height: 1.1em;
    }
    /* Add this to your <style> section */

@keyframes flashCallButton {
  0% {
    background-color: #d9534f; /* Original button red */
    box-shadow: 0 3px 7px rgba(200,50,50,0.35);
    transform: scale(1);
  }
  50% {
    background-color: #e74c3c; /* A slightly brighter or different shade of red */
    box-shadow: 0 3px 15px rgba(220,40,40,0.6); /* More prominent shadow */
    transform: scale(1.05); /* Slightly larger */
  }
  100% {
    background-color: #d9534f; /* Back to original */
    box-shadow: 0 3px 7px rgba(200,50,50,0.35);
    transform: scale(1);
  }
}

.call-button {
  /* It will already have some styles from the previous code.
     Make sure it has a base background-color if not already set by an image,
     then add the animation property below.
     If it uses background-image, the flash might look different or need adjustment.
     Our current .call-button has a solid background-color.
  */
  background-color: #d9534f; /* Ensure this base color is set */
  animation: flashCallButton 2s infinite ease-in-out; /* Apply the animation */
  /* You can adjust '2s' to make it flash faster or slower */
}
  </style>
</head>
<body>
  <div class="opening-quote" id="openingQuoteDisplay">
    </div>
  <h1>How Are You Feeling, My Love?</h1>

  <div class="emojis">
    <div class="emoji-container" data-mood="excited">ðŸ¤©</div>
    <div class="emoji-container" data-mood="happy">ðŸ˜Š</div>
    <div class="emoji-container" data-mood="confused">ðŸ˜•</div>
    <div class="emoji-container" data-mood="crying">ðŸ˜¢</div>
    <div class="emoji-container" data-mood="angry">ðŸ˜ </div>
  </div>

  <div class="mood-info">
    <div class="emotion-text" id="emotion-text-display">Select how you're feeling above</div>
    <div class="quote" id="quote-display">Every feeling of yours is so important to me ðŸ’–</div>
  </div>

  <textarea id="babesResponseInput" placeholder="Share your thoughts here, my beautiful..."></textarea>
  
  <div class="action-buttons">
    <button id="saveResponseButton">Save Your Thoughts</button>
    <a href="tel:+918905507092" class="call-button" id="callMeButton">Nahi Ho Raha Button</a>
  </div>

  <div class="save-status" id="save-status-display"></div>

  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

  <script>
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCHqhrAzrqHOZwZw0r8b-iAzAqq3sGSiB0", // YOUR ACTUAL API KEY
      authDomain: "test-26-05.firebaseapp.com",       // YOUR ACTUAL AUTH DOMAIN
      projectId: "test-26-05",                        // YOUR ACTUAL PROJECT ID
      storageBucket: "test-26-05.firebasestorage.app",// YOUR ACTUAL STORAGE BUCKET
      messagingSenderId: "372804768059",              // YOUR ACTUAL SENDER ID
      appId: "1:372804768059:web:b992f4fdc09ed3ea84671e", // YOUR ACTUAL APP ID
      measurementId: "G-RG2RZ8K4QB"                   // YOUR ACTUAL MEASUREMENT ID (Optional for Firestore)
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const openingQuoteDisplay = document.getElementById("openingQuoteDisplay");
    const emotionTextDisplay = document.getElementById("emotion-text-display");
    const quoteDisplay = document.getElementById("quote-display");
    const babesResponseInput = document.getElementById("babesResponseInput");
    const allEmojiElements = document.querySelectorAll(".emoji-container");
    const saveResponseButton = document.getElementById("saveResponseButton");
    const saveStatusDisplay = document.getElementById("save-status-display");
    // const callMeButton = document.getElementById("callMeButton"); // Not strictly needed if using href directly
    const bodyElement = document.body;

    let selectedMood = "";

    const moodSharingQuotes = [
        "Sharing your feelings is a sign of strength, my love.",
        "I'm always here to listen, no matter the mood.",
        "Your emotions are valid and important to me.",
        "Every mood you share helps me understand you more.",
        "Never hesitate to tell me how you're truly feeling.",
        "Your heart is safe with me; share what's in it.",
        "Expressing yourself is a beautiful thing.",
        "I'm here for all of it - the sunshine and the rain."
    ];

    const moodDetails = {
      excited: { bgColor: "#fff1c9", text: "Excited!", quote: "So thrilled to see you shining so bright! âœ¨" },
      happy:   { bgColor: "#fceabb", text: "Happy!", quote: "Your happiness makes my whole world brighter! ðŸ˜„" },
      confused:{ bgColor: "#e0e0ff", text: "A Bit Confused?", quote: "It's okay to feel unsure, I'm here with you. ðŸ’­" },
      crying:  { bgColor: "#cce2ff", text: "Feeling Sad...", quote: "It's okay to cry, my love. Let it out, I'm listening. ðŸ’”" },
      angry:   { bgColor: "#ffcccc", text: "Feeling Angry?", quote: "It's okay to feel this way. Talk to me about it. â¤ï¸â€ðŸ”¥" }
    };

    // Function to display a random opening quote
    function displayRandomOpeningQuote() {
        if (openingQuoteDisplay) {
            const randomIndex = Math.floor(Math.random() * moodSharingQuotes.length);
            openingQuoteDisplay.innerHTML = `"${moodSharingQuotes[randomIndex]}"`;
        }
    }

    // Display quote when the page loads
    document.addEventListener('DOMContentLoaded', () => {
        displayRandomOpeningQuote();
        checkSaveButtonState(); // Initial check for the save button
    });

    allEmojiElements.forEach(emojiContainer => {
      emojiContainer.addEventListener("click", () => {
        allEmojiElements.forEach(el => el.classList.remove("selected"));
        emojiContainer.classList.add("selected");

        selectedMood = emojiContainer.dataset.mood;
        const moodInfo = moodDetails[selectedMood];

        bodyElement.style.backgroundColor = moodInfo.bgColor;
        bodyElement.style.backgroundImage = 'none';

        emotionTextDisplay.innerText = moodInfo.text;
        quoteDisplay.innerText = moodInfo.quote;
        babesResponseInput.placeholder = `Share more about feeling ${moodInfo.text.toLowerCase().replace(/[!?]/g,'')}...`;
        checkSaveButtonState();
      });
    });

    function checkSaveButtonState() {
        saveResponseButton.disabled = !selectedMood;
    }

    saveResponseButton.addEventListener("click", () => {
      const herResponse = babesResponseInput.value;
      const date = new Date().toLocaleString(); 

      if (!selectedMood) {
        saveStatusDisplay.textContent = "Please pick a mood first, my darling!";
        setTimeout(() => saveStatusDisplay.textContent = "", 3000);
        return;
      }
      if (!herResponse.trim()) {
        saveStatusDisplay.textContent = "Please share a little something, beautiful! ðŸ’–";
        setTimeout(() => saveStatusDisplay.textContent = "", 3000);
        return;
      }

      saveResponseButton.disabled = true;
      saveResponseButton.textContent = "Saving...";
      saveStatusDisplay.textContent = "";

      db.collection("moodEntries").add({
        mood: selectedMood,
        note: herResponse,
        displayTimestamp: date, 
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      })
      .then((docRef) => {
        console.log("Document written to Firebase with ID: ", docRef.id);
        saveStatusDisplay.textContent = "Got it! Your thoughts are safe with me, my love ðŸ’–";
        babesResponseInput.value = ""; 
      })
      .catch((error) => {
        console.error("Error adding document to Firebase: ", error); 
        saveStatusDisplay.textContent = "Oh no! Couldn't save right now. Maybe try again? â¤ï¸";
      })
      .finally(() => {
        saveResponseButton.disabled = !selectedMood; 
        saveResponseButton.textContent = "Save Your Thoughts";
        setTimeout(() => saveStatusDisplay.textContent = "", 5000);
      });
    });

    // Note: The call button uses a direct href="tel:..." so it doesn't strictly need a JS listener
    // unless you wanted to add more complex behavior or analytics.
  </script>
</body>
</html>
